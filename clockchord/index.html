<!DOCTYPE html>
<HTML>
<HEAD>
<meta charset="UTF-8">
<meta name="keywords" content="ClockChord,JavaScript,CircleOfFifths,ChordProgression,MIDI,五度圏,コード進行,時計,楽器">
<meta name="viewport" content="width=device-width">
<meta property="og:title" content="ClockChord">
<meta property="og:description" content="Musical chord instrument on the circle-of-fifths clock">
<link rel="shortcut icon" href="../midichordhelper.ico">
<TITLE>ClockChord - Musical chord instrument on the circle-of-fifths clock</TITLE>
<script src="https://unpkg.com/encoding-japanese@2.1.0/encoding.min.js"></script>
<script src="https://widget.songle.jp/v1/api.js"></script>
<script src="./circle_of_5ths_clock_chord.js"></script>
<script>new CircleOfFifthsClock();</script>
<style type="text/css">
	#background_mode_select {
		right: 20px;
		top: 3px;
	}
	#background_mode_select input[type="radio"] {
		opacity: 0;
		position: fixed;
	}
	#background_mode_select label {
		font-size: medium;
	}
	#background_mode_select label:has(input:focus) {
		outline-style: auto;
	}
	#theme_select {
		right: 4px;
		top: 32px;
	}
	#theme_select input[type="radio"] {
		opacity: 0;
		position: fixed;
	}
	#theme_select label {
		font-size: medium;
	}
	#theme_select label:has(input:focus) {
		outline-style: auto;
	}
	#theme_select label[for="theme_light"] {
		background-color: white;
	}
	#theme_select label[for="theme_dark"] {
		background-color: #404040;
	}
	h1,h2,h3 { color:#FF6633; background-color:#FFFF99; }
	dt { font-weight: bold; }
	@media screen and (max-width: 880px) {
		#ClockChord {
			flex-direction: column;
		}
	}
	#ClockChord {
		display: flex;
	}
	.clock {
		position: relative;
		width: 400px; height: 400px;
		margin: 8px 10px 0px 10px;
	}
	.clock.dark {
		color: white;
		background-color: #404040;
	}
	.clock > * { position: absolute; }
	#keyselect_label {
		top: 1px;
		left: 2px;
		display: flex;
		flex-direction: column;
	}
	#minor_label {
	  z-index: 1;
	  top: 1px;
	  left: 24px;
	}
	#setkey {
		z-index: 1;
		top: 1px;
		left: 58px;
		width: 36px;
		padding-inline: 0;
		visibility: hidden;
	}
	#enharmonic {
		z-index: 1;
		top: 52px;
	}
	#autoChordPlayContainer {
		left: 0;
		bottom: 26px;
	}
	#chord_text_box {
		display: flex;
		z-index: 1;
		bottom: 0;
	}
	#chord_text {
		width: 60px;
	}
	.chord-tap {
		touch-action: none; /* no gesture */
		user-select: none; /* standard syntax */
		-webkit-user-select: none; /* webkit (safari, chrome) browsers */
		-moz-user-select: none; /* mozilla browsers */
		-khtml-user-select: none; /* webkit (konqueror) browsers */
		-ms-user-select: none; /* IE10+ */
	}
	.circle {
		border-radius: 50%;
	}
	#center_chord {
		z-index: 1;
		font-size: 170%;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		padding: 10px;
		border-radius: 50%;
		background: radial-gradient(#FFFFFFD0 50%, #FFFFFF00);
	}
	#center_chord.dark {
		background: radial-gradient(#404040D0 50%, #40404000);
	}
	#volume {
		width: 360px;
	}
	#chordbar {
		width: 424px;
		height: 50px;
		background-color: #E0E0E0;
		border-width: 1px;
		border-color: #D0D0D0;
		margin-top: 8px;
		text-align: center;
		display: flex;
		align-items: center;
		justify-content: center;
	}
	#chord {
		font-size: 170%;
		margin: 8px;
		height: 40px;
	}
	#pianokeyboard {
		min-width: calc(30px * 7 * 2);
		max-width: calc(30px * (7 * 10 + 5));
		height: 160px;
		min-height: 120px;
		max-height: 200px;
		background-color: #808080; color: white;
		border-style: solid;
		border-color: #C0C0C0;
		overflow-x: auto;
		resize: both;
		position: relative;
		scroll-snap-type: x mandatory;
		touch-action: manipulation; /* disable double-tap zoom */
	}
	.whitekey,.blackkey {
		position: absolute;
		top: 1px;
		display: flex;
		justify-content: center;
		align-items: flex-end;
		cursor: default; /* Prevent "cursor: text" on keybind text */
		--indicator-color: #F08080;
	}
	.whitekey {
		width: 28px;
		height: calc(100% - 30px);
		background-color: #F0F0F0;
		border-style: groove;
		border-width: 0 1px 1px 1px;
		border-color: #C0C0C0;
		border-radius: 0 0 4px 4px;
		scroll-snap-align: start;
		color: rgba(0, 0, 0, 50%);
	}
	.pressed.whitekey {
		border-style: inset;
		background: radial-gradient(ellipse 50% 15% at 50% 85%, var(--indicator-color) 8% 20%, #F0F0F0);
	}
	:not(.pressed).chord.whitekey {
		background: radial-gradient(ellipse 40% 12% at 50% 85%, var(--indicator-color) 8% 20%, #F0F0F0);
	}
	.blackkey {
		width: 15px;
		height: calc((100% - 30px) * 0.65 - 12px);
		z-index: 1;
		background-color: #282828;
		border-style: outset;
		border-left-style: inset;
		border-width: 0 3px 12px 3px;
		border-color: #282828;
		border-radius: 0 0 3px 3px;
		color: rgba(255, 255, 255, 50%);
	}
	.pressed.blackkey {
		border-style: solid;
		background: radial-gradient(ellipse 70% 25% at 50% 75%, var(--indicator-color) 20% 20%, #282828);
	}
	:not(.pressed).chord.blackkey {
		background: radial-gradient(ellipse 50% 20% at 50% 75%, var(--indicator-color) 20% 20%, #282828);
	}
	.chord.root { --indicator-color: #FF2020; }
	.frequency {
		position: absolute;
		top: calc(100% - 30px);
		z-index: 1;
	}
	:has(> .shift_button_line) {
		width: 200px;
	}
	summary {
	  margin: 0.25em;
	  width: fit-content;
	}
	details {
	  width: 410px;
	}
	details > div {
	  margin-left: 1em;
	  margin-right: 0.5em;
	}
	.shift_button_line {
		display: flex;
		flex-direction: row;
		justify-content: space-around;
	}
	.shift_button {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 72px;
		height: 72px;
		border: 1px solid;
		border-radius: 50%;
		touch-action: none;
	}
	.shift_button.pressed {
		background: yellow;
	}
	#shift_key_description {
	  display: flex;
	  flex-wrap: wrap;
	  row-gap: 1em;
	  column-gap: 1em;
	  align-items: center;
	  border: 1px solid;
	  border-radius: 4px;
	  padding: 0.5em;
	}
	.right_click_icon {
	  height: 1.5em;
	}
	.pckey {
	  background-color: #DDDDDD;
	  border-style: outset;
	}
	label,.envelope_value {
		font-size: small;
	}
	#velocityValue {
		display: inline-block;
		font-size: small;
		width: 1.5em;
		text-align: right;
	}
	#envelope {
	  margin-top: 4px;
	  display: flex;
	  flex-wrap: wrap;
	}
	.envelope_param {
	  display: flex;
	  flex-direction: column;
	}
	#wave {
		margin-top: 8px;
	}
	#periodicWaveTerms {
		display: flex;
		flex-direction: column;
	}
	#periodicWaveTerms .periodicWaveTerms {
		display: flex;
	}
	#midi {
		display: flex;
		align-items: flex-start;
	}
	#midi > * {
		display: flex;
		flex-direction: column;
		margin-left: 10px;
	}
	#midi > *:first-child {
		margin-left: 0;
	}
	#midi * {
		font-size: small;
	}
	#midi_channel {
		margin-top: 2px;
	}
	#midi_sequencer {
		margin-top: 4px;
		padding: 0px 8px;
		border: 1px solid;
		border-radius: 4px;
	}
	#midi_sequencer > *, #midi_sequence > * {
		margin-top: 8px;
	}
	#midi_sequencer > *:last-child {
		margin-top: 8px;
		margin-bottom: 8px;
	}
	#midi_sequencer > div:first-of-type, #midi_sequence > div:first-of-type {
		margin-top: 4px;
	}
	.grayout {
		color: #808080;
	}
	#midi_sequence > .controller {
		display: flex;
	}
	#song_title {
	  font-size: 1.2em;
	}
	#time_position {
		width: 100%;
	}
	#lyrics_box {
		font-size: 120%;
		width: 410px;
		margin-top: 0.25em;
		text-align: center;
	}
	#lyrics {
		font-weight: normal;
	}
	#past_lyrics {
		color: red;
		background-color: pink;
	}
	#WebMidiLinkUrlForm,.SongleUrlFormLine {
		width: 100%;
		display: flex;
		margin-top: 4px;
		column-gap: 4px;
	}
	#WebMidiLinkUrl, #SongleUrl, #SongleKeySig {
		width: 100%;
	}
	#WebMidiLinkSynth {
		width: 100%;
		height: 400px;
	}
	#songleLink {
		border: 1px solid;
	 	border-radius: 4px;
	 	padding: 0px 8px 4px 8px;
	}
	#songleLink .video-player-element {
		aspect-ratio: 16/9;
	}
	#SongleErrorMessage {
		color: red;
	}
	#songleChord {
		font-size: 150%;
		line-height: 1;
	}
</style>
</HEAD>
<BODY BGCOLOR=white>
<h1>ClockChord</h1>
<a href="#how_to_use" style="font-size: small;">How to use</a>
|
<a href="QRcode.html" style="font-size: small;">Open on another device</a>
<hr/>
<div id="ClockChord">
  <div>
    <label for="volume" title="Volume" style="display: flex;">
      <img src="image/speaker.svg" alt="Volume"/>
      <input id="volume" type="range" value="0.5" min="0" max="1.6" step="0.01"/>
    </label>
    <div class="clock">
      <label id="minor_label" for="minor"><input id="minor" type="checkbox">m</input></label>
      <button id="setkey" title="Set the chord as key signature"></button>
      <label id="keyselect_label" for="keyselect" title="Select key signature to normalize chord ♯/♭ notation">Key<select id="keyselect" style="height: 32px;">
        <option value="0"></option>
      </select></label>
      <button id="enharmonic" title="Enharmonic key"></button>
      <canvas id="circleOfFifthsClockDialCanvas" class="circle" width="400px" height="400px">HTML5 canvas not supported</canvas>
      <canvas id="circleOfFifthsClockBeatCanvas" class="circle" width="400px" height="400px"></canvas>
      <canvas id="circleOfFifthsClockToneIndicatorCanvas" class="circle" width="400px" height="400px"></canvas>
      <canvas id="circleOfFifthsClockCanvas" class="circle" width="400px" height="400px"></canvas>
      <canvas id="circleOfFifthsClockChordButtonCanvas" class="circle disable_selection chord-tap" width="400px" height="400px" tabindex="0"></canvas>
      <span id="center_chord" class="disable_selection chord-tap"></span>
      <div id="background_mode_select">
        <label for="bg_pie" aria-label="Pie" title="Pie"><input type="radio" id="bg_pie" name="background_mode" value="pie" checked>🪭</input></label>
        <label for="bg_donut" aria-label="Donut" title="Donut"><input type="radio" id="bg_donut" name="background_mode" value="donut">⭕</input></label>
      </div>
      <div id="theme_select">
        <label for="theme_light" aria-label="Light" title="Light"><input type="radio" id="theme_light" name="theme" value="light" checked>🌞</input></label>
        <label for="theme_dark" aria-label="Dark" title="Dark"><input type="radio" id="theme_dark" name="theme" value="dark">🌛</input></label>
      </div>
      <div id="autoChordPlayContainer" title="Auto chord play by Songle">
        <input id="autoChordPlay" type="checkbox" checked
          aria-label="Auto chord play by Songle"
        >Auto</input>
      </div>
      <div id="chord_text_box">
        <input id="chord_text" name="chord_text" type="text" placeholder="Chord"
          aria-label="Chord"
          title="Chord"
        ></input>
        <button id="enter_chord" aria-label="Enter">⏎</button>
      </div>
    </div>
    <div id="lyrics_box">
      <span id="past_lyrics"></span><span id="lyrics"></span>
    </div>
    <details>
      <summary>7 M7 6 -5 aug add9</summary>
      <div>
        <div id="shift_button_container">
          <div class="shift_button_line">
            <div id="button_major7th" class="shift_button"><b>M7</b>/6</div>
          </div>
          <div class="shift_button_line">
            <div id="button_add9" class="shift_button"><b>add9</b></div>
            <div id="button_7th" class="shift_button"><b>7</b>/6</div>
          </div>
          <div class="shift_button_line">
            <div id="button_flat5" class="shift_button"><b>-5/aug</b></div>
          </div>
        </div>
        <div id="shift_key_description">
          <div>
            <b>7</b>:<img
              src="image/right_click.svg"
              class="right_click_icon"
              alt="Right click" title="Right click"
            />
          </div>
          <div>
            <b>M7</b>:<span class="pckey">Shift</span> + <img
              src="image/right_click.svg"
              class="right_click_icon"
              alt="Right click" title="Right click"
            />
          </div>
          <div><b>6</b>:<span class="pckey">Shift</span></div>
          <div><b>-5</b>:<span class="pckey">Alt</span></div>
          <div><b>aug</b>:<span class="pckey">Alt</span> + sus4</div>
          <div><b>add9</b>:<span class="pckey">Ctrl</span></div>
          <div><b>dim7</b>:m6-5</div>
          <div>...and any combination available!</div>
        </div>
      </div>
    </div>
  </detail>
  <div style="width: 100%;">
    <fieldset id="songleLink">
      <legend><a href="https://songle.jp/" target="_blank">Songle</a> player</legend>
      <div>
        <span id="songleTempo">
          <img width="16" src="image/note4.svg" alt="BPM"/>=
          <span id="songleBpm"></span>
        </span>
        <span id="songlePosition"></span>
        <span id="songleChord"></span>
      </div>
      <div id="EmbeddedSongle">
        <div id="SongleErrorMessage"></div>
      </div>
      <div id="SongleUrlForm">
        <div class="SongleUrlFormLine">
          <label for="SongleUrl">URL</label>
          <input id="SongleUrl" type="text" name="url" title="Song URL registered on Songle"/>
        </div>
        <div class="SongleUrlFormLine">
          <label for="SongleKeySig">Key</label>
          <input id="SongleKeySig" type="text" name="key"
            placeholder="Bb,123456,Am,789012,F#m,…"
            title="Key-signature timeline (key,millisecond,key,ms,key,ms,key,…)"
          />
          <button id="LoadSongleUrl">Load</button>
        </div>
      </div>
      <div><a href="https://camidion.wordpress.com/clockchord-songle-playlist/">Recommended songs</a></div>
    </fieldset>
    <fieldset id="midi_sequencer">
      <legend>MIDI player</legend>
      <div id="midi_sequence">
        <div id="song_title"></div>
        <div class="controller">
          <button id="play_pause">
            <img id="play_pause_icon" width="16" src="image/play-button-svgrepo-com.svg" alt="Play"/>
          </button>
          <button id="top">
            <img width="16" src="image/skip-back-filled-svgrepo-com.svg" alt="Back to top"/>
          </button>
          <input type="range" id="time_position" value="0" min="0" max="1" step="1"></input>
        </div>
        <div>
          <span id="time_signature" class="grayout">4/4</span>
          <span id="key" class="grayout">Key: C</span>
          <span id="tempo" class="grayout">
            <img width="16" src="image/note4.svg" alt="BPM"/>=
            <span id="bpm"></span>
          </span>
          <span id="song_marker"></span>
        </div>
        <div id="song_text"></div>
      </div>
      <div id="midi_file_selecter">
        <input type="file" id="midi_file" accept="audio/midi" style="display: none;"/>
        <button id="midi_file_select_button">MIDI file</button>
        <span id="midi_file_name">Select or drop here to play</span>
      </div>
    </fieldset>
    <div>
      <div id="chordbar">
        <span id="chord" title="Chord"></span>
      </div>
      <div id="pianokeyboard" tabindex="0">
        <div class="whitekey"></div>
        <div class="blackkey"></div>
        <div class="frequency"><a href="http://www.yk.rim.or.jp/~kamide/music/notes.html" target="_blank">440Hz</a></div>
      </div>
    </div>
    <div style="display: flex; align-items: center; column-gap: 4px;">
      <span>
        <label for="velocity" title="Velocity">Velocity</label>
        <span id="velocityValue"></span>
      </span>
      <input
        id="velocity" type="range" value="64" min="0" max="127" step="1"
      />
      <label for="midi_channel">
        Channel
        <select id="midi_channel">
        </select>
      </label>
    </div>
    <hr/>
    <div style="margin-top: 8px; display: flex;">
      <label for="program_select">
        <select id="program_select">
        </select>
      </label>
      <div id="instrument_name"></div>
    </div>
    <div id="wave">
      <label for="waveselect" title="wave">
        <img id="waveIcon" alt="wave" height="32" align="center"/>
        <select id="waveselect" style="height: 32px;">
        </select>
      </label>
      <div id="periodicWaveTerms">
        <datalist id="terms_datalist">
          <option value="-1"></option>
          <option value="-0.5"></option>
          <option value="0"></option>
          <option value="0.5"></option>
          <option value="1"></option>
        </datalist>
        <div class="periodicWaveTerm">
          <input type="range" value="0" min="-1" max="1" step="0.01" list="terms_datalist"/>
          <input type="range" value="0" min="-1" max="1" step="0.01" list="terms_datalist"/>
          <span class="periodicWaveFormula">0e<sup>i</sup></span>
          <button style="margin-left: 8px;" title="Append">+</button>
          <button style="margin-left: 8px;" title="Remove">-</button>
        </div>
      </div>
    </div>
    <div id="envelope">
      <img id="envelopeIcon" alt="envelope" title="envelope" src="image/envelope.svg" height="32" align="center"/>
      <div class="envelope_param">
        <span>
          <label for="attackTime">Attack time</label>
          <span id="attackTimeValue" class="envelope_value"></span>
        </span>
        <input id="attackTime" type="range" value="0.01" min="0" max="2" step="0.001"/>
      </div>
      <div class="envelope_param">
        <span>
          <label for="decayTime">Decay time</label>
          <span id="decayTimeValue" class="envelope_value"></span>
        </span>
        <input id="decayTime" type="range" value="0.5" min="0" max="2" step="0.01"/>
      </div>
      <div class="envelope_param">
        <span>
          <label for="sustainLevel">Sustain level</label>
          <span id="sustainLevelValue" class="envelope_value"></span>
        </span>
        <input id="sustainLevel" type="range" value="0.3" min="0" max="1" step="0.01"/>
      </div>
      <div class="envelope_param">
        <span>
          <label for="releaseTime">Release time</label>
          <span id="releaseTimeValue" class="envelope_value"></span>
        </span>
        <input id="releaseTime" type="range" value="0.2" min="0" max="2" step="0.01"/>
      </div>
    </div>
    <hr/>
    <div id="midi">
      <div id="midi_input">
        <span>
          <img alt="MIDI IN" title="MIDI IN" src="image/midi.svg" height="32" align="center"/>
          MIDI IN
        </span>
      </div>
      <div id="midi_output">
        <span>
          <img alt="MIDI OUT" title="MIDI OUT" src="image/midi.svg" height="32" align="center"/>
          MIDI OUT
        </span>
      </div>
    </div>
    <hr/>
    <div id="WebMidiLink">
      <div>
        <a href="https://www.g200kg.com/en/docs/webmidilink/" target="_blank">WebMidiLink</a> OUT
      </div>
      <div id="WebMidiLinkUrlForm">
        <label for="WebMidiLinkUrl">URL</label>
        <input id="WebMidiLinkUrl" type="url"/>
        <button id="LoadWebMidiLinkUrl">Load</button>
      </div>
      <iframe id="WebMidiLinkSynth"></iframe>
    </div>
  </div>
</div>
<hr/>
<a name="how_to_use"></a>
<h1>五度圏時計楽器 ClockChord</h1>
<h2>操作方法（Operation）</h2>
<p>和音の出る五度圏時計です。文字盤のコード名をクリックまたはタッチしてみてください。</p>
<p>Chord-soundable circle-of-fifths clock - Click or touch the chord symbol on dial</p>
<h3>For PC</h3>
<h4>マウス操作</h4>
<p>時計の文字盤を左クリックすると、そこに書かれているコードが鳴ります。一番外側の調号の部分をクリックするとsus4を鳴らせます。</p>
<p>押したまま円周方向になぞってコードをかき鳴らすこともできます（放射方向には反応しません）。時計回りと反時計回りで音の順序が反転します。</p>
<p>右クリックで7thも鳴らせます（メジャー、マイナー、sus4のどこで右クリックしても7がつきます）。</p>
<p>Shift、Ctrl、Altキーを組み合わせると、さらに多くの種類のコード(M7、6、-5、aug、dim7、9、add9など)を鳴らすことができます。キー割り当ては<a href="http://www.yk.rim.or.jp/~kamide/music/chordhelper/" target="_blank">MIDI Chord Helper</a>と同じです。詳しくは<a href="http://www.yk.rim.or.jp/~kamide/music/chordhelper/manual.html#chord_play" target="_blank">MIDI Chord Helper マニュアル：マウスでコードを鳴らす</a>を参照してください。</p>
<p>鍵盤部分をマウスで押してメロディを弾くこともできます。</p>
<h4>PCキーボード操作</h4>
<p>文字盤にフォーカスを入れると、PCのキーボードでコードを弾けます。6YHの列が、現在の調と同名のコードに割り当てられます。
</p>
<p>矢印キーで調号選択の切り替えも可能です（↑半音UP、↓半音DOWN、←1時間戻る、→1時間進む）。
</p>
<p>PCキーボードの場合は右クリックできないので、MIDI Chord Helper と同様にShiftキーで代用できるようにしています。なお、マウスの場合のShiftキーの機能はMetaキー（Windowsキー）に割り当ててみましたが、OSによってはMetaキーをうまく検知できず、本来の機能として思わぬ動作をしてしまう場合があるので注意してください。
</p>
<p>鍵盤部分にフォーカスを入れると、PCのキーボードで演奏できます。ただし、<strong>PCのキーボードは同時押しのできない組み合わせがあることが多い</strong>ため、特定の和音が出せないことがあります。このような煩わしい制約から逃れる手段として、MIDI INポートにMIDIキーボードを接続して使う方法がありますので、ぜひお試し下さい。</p>
<h3>For smartphone, tablet PC</h3>
<h4>タッチ操作</h4>
<p>スマホやタブレットのようなタッチ操作デバイスの場合も、タップしてコードを鳴らしたり、円周方向になぞってかき鳴らすことができます。</p>
<p>右クリックやShiftキーなどが使えなくても色々なコードを鳴らせるよう、代替手段として<a href="http://www.yk.rim.or.jp/~kamide/music/chordhelper/hardware/" target="_blank">電子楽器CAmiDion</a>と同様のシフトボタン（Maj7、add9、7th、-5/aug）が文字盤の下に現れます。
<a href="http://www.yk.rim.or.jp/~kamide/music/chordhelper/hardware/button_operation_table.html" target="_blank">CAmiDionボタン操作表</a>と同じ割当なので、そのままマルチタッチで同時押しを組み合わせ、色々なコードを鳴らすことができます。</p>
<p>鍵盤部分を押してメロディを弾くこともできます（スマホだとちょっと狭いので、できればタブレットがおすすめ）。</p>
<h3>調号選択</h3>
<p>曲のキーがわかっている場合、Keyプルダウンで調号の♯、♭の数を選択してみてください。
コードの♯、♭の表記が調整され、そのキーにとってよりふさわしい表記に変わります。</p>
<p>【例】</p>
<dl>
<dt>調号を4♯（4時の位置： E/C♯m）に設定した場合</dt>
<dd>8時の位置が A♭/Fm → G♯/E♯m に変わります。</dd>
<br/>
<dt>調号を4♭（8時の位置： A♭/Fm）に設定した場合</dt>
<dd>4時の位置が E/C♯m → F♭/D♭m に変わります。</dd>
</dl>
<p>このように調号の♯、♭の数が多くなると、白鍵の音階なのに♯、♭がついたり、ときには&#x1D12A;(ダブルシャープ)、&#x1D12B;(ダブルフラット)が出現することがあります。</p>
<h4>トーンインジケーターの色との関係</h4>
<p>音を鳴らすと、<a
 href="http://www.yk.rim.or.jp/~kamide/music/chordhelper/manual.html#chord_display"
 target="_blank">MIDI Chord Helper と同じようなトーンインジケーター</a>が文字盤に現れますが、この表示色も調号選択に応じて変化します。
<dl>
<dt>スケールに乗っている音（マイナーキーのときはナチュラルマイナースケール）</dt>
<dd><span style="color: hotpink;">ピンク色</span></dd>
<br/>
<dt>それ以外の（スケールを外れた）音</dt>
<dd>♯方向に外れた場合は<span style="color: goldenrod;">黄色</span>、♭方向に外れた場合は<span style="color: blue;">青色</span></dd>
</dl>
</p>
<h4>切り替えボタンの出現条件</h4>
<p>次の場合、プルダウン操作なしで簡単に調号を切り替えられるボタンが現れます。</p>
<dl>
<dt>♯、♭の数が5〜7個</dt>
<dd>異名同音の調号への切り替えボタンが現れます。</dd>
<br/>
<dt>選択中の調号と鳴らしたコードの表記が異なる</dt>
<dd>鳴らしたコードと同名のキーに切り替えるためのボタンが出現します。
キーとして通常使われない表記（例：G♯、D♭m）の場合、通常使われる異名同音の表記（例：A♭、C♯m）に正規化されます。</dd>
</dl>
<h3>表示スタイル選択</h3>
<dl>
<dt>ダークモード</dt>
<dd>🌞Light / 🌛Darkのアイコンで明暗の切り替えができます。OSやブラウザの設定にも反応します。
</dd>
<br/>
<dt>文字盤の背景モード</dt>
<dd>次の2種類から選べます。
<dl>
<dt>⭕Donut</dt>
<dd>ドーナツモード - 3つのドーナツ状の領域（<span
 style="color: blue;">マイナー</span>、<span
 style="color: hotpink;">メジャー</span>、<span
 style="color: goldenrod;">sus4</span>）それぞれに色をつけるモードです。
<a href="http://www.yk.rim.or.jp/~kamide/music/theory/" target="_blank">音楽理論のツボのページ</a>のように背景モードの選択肢を設置していない場合のデフォルトです。
</dd>
<dt>🪭Pie</dt>
<dd>パイモード - 4等分したピザパイのような扇形の4つの領域それぞれに色をつけるモードです（当ページにおけるデフォルト）。
MIDI Chord Helperと同様、選んだ調号に応じて背景色が動き、時計回りの順で次のようになります。
<ul>
<li><span style="color: hotpink;">ピンク色</span> - その調でよく使う、ダイアトニックコード</li>
<li><span style="color: goldenrod;">黄色</span> - <span
 style="color: hotpink;">短調</span>→<span
 style="color: goldenrod;">長調</span>の同主調転調後によく使う、<span
 style="color: goldenrod;">ホット</span>に聞こえるコード</li>
<li><span style="color: green;">緑色</span> - 真裏の調でよく使うコード</li>
<li><span style="color: blue;">青色</span> - <span
 style="color: hotpink;">長調</span>→<span
 style="color: blue;">短調</span>の同主調転調後によく使う、<span
 style="color: blue;">クール</span>に聞こえるコード</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<h3>MIDIファイル再生</h3>
<p>内蔵MIDIシーケンサーにより、MIDIファイルを選択して再生できます。
</p>
<p>MIDI player の枠にMIDIファイルをドラッグ＆ドロップ、または MIDI file ボタンからファイルを選択して読み込ませると、自動的に🌛ダークモード/🪭Pieモードになって再生されます。
このモードにすると、まるでイルミネーションのようにトーンインジケーターが美しく光り輝き、その曲のコード進行を視覚的に実感できます。
</p>
<p>MIDIファイルに調号変更メタイベントが設定されていれば、再生時に所定のタイミングで自動的に調号選択が変更されます。
</p>
<h3>MIDI IN/OUT 選択</h3>
<p>MIDIポートを装備している場合、ポート名のチェックボックスが現れますので、接続したいポートをチェックしてください。</p>
<p>MIDIチャンネルを選択して、MIDI OUTに出力するチャンネルを変更できます。</p>
<p><a href="https://www.g200kg.com/en/docs/webmidilink/" target="_blank">WebMidiLink</a>のリンクレベル0にも対応していますので、<a href="https://www.g200kg.com/websequencer/" target="_blank">WebSequencer</a>と接続することで、MIDI再生結果をClockChordのトーンインジケータに表示してコード進行を視覚化しながら鳴らすこともできます。
</p>
<p>※ MIDIの規格上、MIDIポートにメタイベントを流すことはできないので、外部のMIDIシーケンサーで再生しても調号の自動選択は働きません。
調号を自動選択させたい場合は、内蔵MIDIシーケンサーで再生してください。
</p>
<h3>Songle Widget にコード演奏させる</h3>
<p><a href="https://widget.songle.jp/" target="_blank">Songle Widget</a> がリアルタイムに出力するコードを ClockChord で自動的に鳴らすこともできます。</p>
<h4>操作方法</h4>
<p>Songle player の枠に下記の値を入力し、[Load]ボタンをクリックします。</p>
<ol>
<li>楽曲のURL（YouTube、niconicoなど）<ul>
  <li><a href="https://songle.jp/" target="_blank">能動的音楽鑑賞サービスSongle（ソングル）</a>に登録されている楽曲のみ有効です。</li>
  <li>Songleに登録されていても、そのURLの楽曲が削除されている場合は、再生できません。</li>
</ul></li>
<li>曲のキー（例：B♭、F♯m など）<ul>
  <li>不明な場合、とりあえず省略したまま再生してみましょう。<ul>
    <li>曲が終わったように聞こえるコードが見つかれば、それがその曲のキーです。</li>
  </ul></li>
  <li>フラット（♭）は小文字の b、シャープ（♯）は半角記号の # としても指定できます。</li>
  <li>音名の代わりに、調号の♯の数（負数で♭の数）で指定することもできます。<ul>
    <li>例：A → 3、Am → 0m、C → 0、Cm → -3m</li>
    <li>7 〜 -7 の範囲を外れていた場合（例：8、-8m）、範囲に収まる異名同音のキー（例：-4、4m）に正規化されます。</li>
  </ul></li>
  <li>通常使われない音名表記のキー（例：G♯、D♭m）を指定した場合、異名同音のキー（例：A♭、C♯m）に正規化されます。</li>
</ul></li>
</ol>
<p>→ Songle Widget の埋め込みプレーヤーが表示されます（YouTubeの広告や、niconicoの流れるコメントも表示されます）。
</p>
<p>文字盤の背景色が自動的に🌛ダークモード/🪭Pieモードに設定され、キーの指定があればそれも反映されます。
再生が始まると、Songle Widget からのコードも文字盤に表示され、まるでイルミネーションのようにトーンインジケーターが美しく光り輝き、
曲のコード進行を視覚的に実感できます。
</p>
<h4>転調がある場合</h4>
<p>Key欄に入力したキーに追加で、転調位置（ミリ秒[ms]単位）、転調先のキー、この2つを交互にカンマ区切りで指定してください。
</p>
<p>例：Dm,123456,Bb,234567,F#m</p>
<ul>
<li>開始時のキー：Dm</li>
<li>123.456秒の位置で B♭ に転調</li>
<li>234.567秒の位置で F♯m に転調</li>
</ul>
<p>転調位置を把握するには、再生途中で転調した！と思った瞬間に一時停止し、埋め込みプレーヤーの上に表示されている現在の再生位置[ms]を確認してください。
</p>
<h4>コードやビートが合ってないなど違和感がある場合</h4>
<p>自動解析されたあとのデータメンテナンスが行き届いていない可能性があります。ぜひ、Songleのデータを訂正してあげてください。
</p>
<h4>手動でコード演奏したくなったら</h4>
<p>Songleで視覚的にコード進行を覚えたので、今度は自分でコード演奏してみたい！ …と思ったら、文字盤左下にある Auto のチェックを外してみましょう。Songleによるコード演奏が止まり、自分で曲に合わせてコード演奏できるようになります。
</p>
<h3>URL検索パラメータ</h3>
<p>ClockChordを開くときに下記のURL検索パラメータを指定できます。
</p>
<dl>
<dt>songle</dt>
<dd>Songle URL欄の入力値を指定します。URLで指定された曲の埋め込まれたSongle Widgetが、ClockChordに最初から埋め込まれた状態で開きます。</dd>
<dt>url</dt>
<dd>パラメータsongleと同じです。</dd>
<dt>keysig</dt>
<dd>Key欄の入力値を指定します。<br/>※ シャープとして半角の # を直接指定しても、<a
 href="https://developer.mozilla.org/ja/docs/Web/URI/Reference/Fragment/Text_fragments" target="_blank">テキストフラグメント</a
>として解釈され、無視されてしまいます。その場合はシャープ記号 ♯ で代用するか、または %23 のように<a
 href="https://developer.mozilla.org/ja/docs/Glossary/Percent-encoding" target="_blank">パーセントエンコーディングを使ってエスケープ</a
>する必要があります。</dd>
<dt>key</dt>
<dd>パラメータkeysigと同じです。</dd>
</dl>
<hr/>
<h2>動作環境（Tested Environment）</h2>
<p>下記の環境で動作を確認できています。</p>
<ul>
<li>[Web Browser] Google Chrome / Firefox</li>
<li>[OS] Ubuntu Linux / Windows / Android / iOS</li>
</ul>
<hr/>
<p>他にも、こんな時計のページを作りました：<a href="http://www.yk.rim.or.jp/~kamide/resistor_color_code_clock.html" target="_blank">抵抗カラーコード時計</a></p>
<hr/>
<p>
[<a href="./circle_of_5ths_clock_chord.js" target="_blank">JavaScript source code</a>]
[<a href="../">Home</a>]
</p>
</BODY>
</HTML>
